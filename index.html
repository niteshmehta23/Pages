<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Basic Form</title>

</head>
<body>

    <h2>Form 1</h2>
    
 <form id="form1" action="/Pages/success.html" method="get">
        <label for="firstName">First Name:</label>
        <input type="text" id="firstName" name="firstName" required>

        <br>

        <label for="lastName">Last Name:</label>
        <input type="text" id="lastName" name="lastName" required>

        <br>

        <label for="email">Email:</label>
        <input type="email" id="email" name="email" required>

        <br>

        <input type="submit" value="Submit">
    </form>
<script src='https://cxpiusa1formui01cdnsa01-endpoint.azureedge.net/tip/FormCapture/FormCapture.bundle.js'></script>
<script>
    // NOTE: for reference see https://go.microsoft.com/fwlink/?linkid=2250770

    d365mktforms.waitForElement("#form1") // example: "#form1" as a selector for form with id="form1"
    .then(form => {
    const mappings = [
        {
            FormFieldName: "firstName",
            DataverseFieldName: "firstname",
        },
        {
            FormFieldName: "lastName",
            DataverseFieldName: "lastname",
        },
        {
            FormFieldName: "email",
            DataverseFieldName: "emailaddress1",
        },

    ];

        form.addEventListener("submit", (e) => {
            const serializedForm = d365mktforms.serializeForm(form, mappings);
            // console.log(JSON.stringify(serializedForm)); // NOTE: enable for debugging
            const payload = serializedForm.SerializedForm.build();

            const captureConfig = {
                FormId: "fe1e4639-7288-ee11-be36-000d3a3b7b06",
                FormApiUrl: "https://public-usa.mkt-tip.dynamics.com/api/v1.0/orgs/77d25efc-5086-ee11-8175-00224803ed7f/landingpageforms"
            }
            d365mktforms.submitForm(captureConfig, payload);
        }, true);
    });
</script>
  
</body>
</html>
